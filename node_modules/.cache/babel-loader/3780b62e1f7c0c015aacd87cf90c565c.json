{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Jacky/Tweetme/Tweetme-2/tweetme2-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Jacky/Tweetme/Tweetme-2/tweetme2-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{apiCommentFeed}from'./lookup';import{Comment}from'./commentdetail';export function CommentFeedList(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),commentsInit=_useState2[0],setCommentsInit=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),nextUrl=_useState6[0],setNextUrl=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),commentsDidSet=_useState8[0],setCommentsDidSet=_useState8[1];useEffect(function(){var final=_toConsumableArray(props.newComments).concat(commentsInit);if(final.length!==comments.length){setComments(final);}},[props.newComments,comments,commentsInit]);useEffect(function(){if(commentsDidSet===false){var handleCommentListLookup=function handleCommentListLookup(response,status){if(status===200){setNextUrl(response.next);setCommentsInit(response.results);setCommentsDidSet(true);}};apiCommentFeed(handleCommentListLookup);}},[commentsInit,commentsDidSet,setCommentsDidSet,props.username]);var handleDidRetweet=function handleDidRetweet(newComment){var updateCommentsInit=_toConsumableArray(commentsInit);updateCommentsInit.unshift(newComment);setCommentsInit(updateCommentsInit);var updateFinalComments=_toConsumableArray(comments);updateFinalComments.unshift(comments);setComments(updateFinalComments);};var handleLoadNext=function handleLoadNext(event){event.preventDefault();if(nextUrl!==null){var handleLoadNextResponse=function handleLoadNextResponse(response,status){if(status===200){setNextUrl(response.next);var newComments=_toConsumableArray(comments).concat(response.results);setCommentsInit(newComments);setComments(newComments);}};apiCommentFeed(handleLoadNextResponse,nextUrl);}};return/*#__PURE__*/React.createElement(React.Fragment,null,comments.map(function(item,index){return/*#__PURE__*/React.createElement(Comment,{comment:item,didRetweet:handleDidRetweet,className:\"my-5 py-5 border bg-white text-dark\",key:\"\".concat(index,\"-{comment.id}\")});}),nextUrl!==null&&/*#__PURE__*/React.createElement(\"button\",{onClick:handleLoadNext,className:\"btn btn-outline-primary\"},\"Load next\"));}","map":{"version":3,"sources":["C:/Users/Jacky/Tweetme/Tweetme-2/tweetme2-web/src/Europa/commentfeed.js"],"names":["React","useEffect","useState","apiCommentFeed","Comment","CommentFeedList","props","commentsInit","setCommentsInit","comments","setComments","nextUrl","setNextUrl","commentsDidSet","setCommentsDidSet","final","newComments","concat","length","handleCommentListLookup","response","status","next","results","username","handleDidRetweet","newComment","updateCommentsInit","unshift","updateFinalComments","handleLoadNext","event","preventDefault","handleLoadNextResponse","map","item","index"],"mappings":"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","sourcesContent":["import React, {useEffect, useState}  from 'react'\r\n\r\nimport {apiCommentFeed} from './lookup'\r\n\r\nimport {Comment} from './commentdetail'\r\n\r\nexport function CommentFeedList(props) {\r\n    const [commentsInit, setCommentsInit] = useState([])\r\n    const [comments, setComments] = useState([])\r\n    const [nextUrl, setNextUrl] = useState(null)\r\n    const [commentsDidSet, setCommentsDidSet] = useState(false)\r\n    useEffect(()=>{\r\n      const final = [...props.newComments].concat(commentsInit)\r\n      if (final.length !== comments.length) {\r\n        setComments(final)\r\n      }\r\n    }, [props.newComments, comments, commentsInit])\r\n\r\n    useEffect(() => {\r\n      if (commentsDidSet === false){\r\n        const handleCommentListLookup = (response, status) => {\r\n          if (status === 200){\r\n            setNextUrl(response.next)\r\n            setCommentsInit(response.results)\r\n            setCommentsDidSet(true)\r\n          }\r\n        }\r\n        apiCommentFeed(handleCommentListLookup)\r\n      }\r\n    }, [commentsInit, commentsDidSet, setCommentsDidSet, props.username])\r\n\r\n\r\n    const handleDidRetweet = (newComment) => {\r\n      const updateCommentsInit = [...commentsInit]\r\n      updateCommentsInit.unshift(newComment)\r\n      setCommentsInit(updateCommentsInit)\r\n      const updateFinalComments = [...comments]\r\n      updateFinalComments.unshift(comments)\r\n      setComments(updateFinalComments)\r\n    }\r\n    const handleLoadNext = (event) => {\r\n      event.preventDefault()\r\n      if (nextUrl !== null) {\r\n        const handleLoadNextResponse = (response, status) =>{\r\n          if (status === 200){\r\n            setNextUrl(response.next)\r\n            const newComments = [...comments].concat(response.results)\r\n            setCommentsInit(newComments)\r\n            setComments(newComments)\r\n          }\r\n        }\r\n        apiCommentFeed(handleLoadNextResponse, nextUrl)\r\n      }\r\n    }\r\n\r\n    return <React.Fragment>{comments.map((item, index)=>{\r\n      return <Comment  \r\n        comment={item} \r\n        didRetweet={handleDidRetweet}\r\n        className='my-5 py-5 border bg-white text-dark' \r\n        key={`${index}-{comment.id}`} />\r\n    })}\r\n    {nextUrl !== null && <button onClick={handleLoadNext} className='btn btn-outline-primary'>Load next</button>}\r\n    </React.Fragment>\r\n  }\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}